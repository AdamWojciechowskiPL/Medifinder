<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè• Medifinder</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>üè• Medifinder</h1>
            <div class="header-right">
                 <span id="userLabel"></span>
                 <button id="authBtn" class="btn btn-sm btn-primary" onclick="loginWithGoogle()">Zaloguj siƒô</button>
            </div>
        </header>

        <!-- Login Overlay -->
        <div id="loginOverlay" class="login-overlay">
            <div class="login-box">
                <h2>üîí Wymagane Logowanie</h2>
                <p style="color: #6b7280; margin-bottom: 24px;">Zaloguj siƒô, aby uzyskaƒá dostƒôp do aplikacji</p>
                <button class="btn btn-primary btn-wide" onclick="loginWithGoogle()">üë§ Zaloguj przez Google</button>
            </div>
        </div>

        <!-- Main Content -->
        <div id="appContent" class="hidden">
            
            <!-- Sekcja 1: ZarzƒÖdzanie profilem -->
            <div class="panel">
                <div class="panel-row">
                    <label><strong>üë§ Profil:</strong> <span id="currentProfileLabel" style="color: var(--primary); font-weight: 600;">Brak</span></label>
                    <button class="btn btn-sm btn-link" onclick="toggleProfilesModal()">Zmie≈Ñ profil</button>
                </div>
                
                <div class="panel-row" style="margin-top: 16px;">
                    <label><strong>üîÑ Status Schedulera:</strong> <span id="autoCheckStatus" style="font-weight: 600;">Wy≈ÇƒÖczony</span></label>
                </div>
                <div class="panel-row indent">
                    <input type="checkbox" id="enableAutoCheck" style="width: 20px; height: 20px; cursor: pointer;">
                    <label for="enableAutoCheck">W≈ÇƒÖcz automatyczne sprawdzanie co</label>
                    <input type="number" id="checkInterval" value="1" min="1" style="width: 60px;">
                    <label>minut</label>
                </div>

                <!-- Szczeg√≥≈Çowy status schedulera -->
                <div class="panel-row indent" id="schedulerDetailsRow" style="display: none; margin-top: 12px;">
                    <div id="schedulerDetails"></div>
                </div>

                <div class="panel-row" style="margin-top: 16px;">
                    <label><strong>üéØ Automatyczna Rezerwacja:</strong> <span id="autoBookStatus" style="font-weight: 600;">Wy≈ÇƒÖczona</span></label>
                </div>
                <div class="panel-row indent">
                    <input type="checkbox" id="autoBook" style="width: 20px; height: 20px; cursor: pointer;">
                    <label for="autoBook">Rezerwuj automatycznie pierwszƒÖ znalezionƒÖ wizytƒô</label>
                </div>

                <!-- Dni tygodnia i godziny -->
                <div class="panel-row" style="margin-top: 20px;">
                    <label style="font-weight: 600; width: 100%;">Preferowane dni tygodnia:</label>
                    <div class="weekdays-selector" id="weekdaysContainer">
                        <!-- Generowane przez JS -->
                    </div>
                </div>
                <div class="panel-row" style="margin-top: 12px;">
                    <label style="font-weight: 600;">Przedzia≈Ç godzinowy:</label>
                    <label>od</label>
                    <input type="number" id="hourFrom" value="4" min="0" max="23" class="hour-input">
                    <label>do</label>
                    <input type="number" id="hourTo" value="19" min="0" max="23" class="hour-input">
                </div>
            </div>

            <!-- Sekcja 2: Kryteria wyszukiwania -->
            <div class="panel">
                <div class="panel-header">üîç Kryteria Wyszukiwania</div>
                
                <div class="search-grid">
                    <!-- Specjalno≈õƒá -->
                    <div class="search-item">
                        <label>Specjalno≈õƒá</label>
                        <select id="specialtySelect" class="form-control">
                            <option value="">-- Wybierz specjalno≈õƒá --</option>
                        </select>
                    </div>

                    <!-- Lekarze Multi-Select -->
                    <div class="search-item">
                        <label>Lekarze</label>
                        <div class="custom-select-container">
                            <button class="custom-select-trigger" id="doctorsTrigger" onclick="toggleDropdown('doctorsDropdown')">
                                Wybierz...
                            </button>
                            <div class="custom-dropdown" id="doctorsDropdown">
                                <div class="dropdown-search">
                                    <input type="text" placeholder="Szukaj lekarza..." onkeyup="filterDropdown(this, 'doctorsList')">
                                </div>
                                <div class="dropdown-list" id="doctorsList"></div>
                                <div class="dropdown-footer">
                                    <button class="btn btn-sm btn-link" onclick="clearSelection('doctorsList')">Wyczy≈õƒá</button>
                                    <button class="btn btn-sm btn-primary" onclick="toggleDropdown('doctorsDropdown')">Gotowe</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Plac√≥wki Multi-Select -->
                    <div class="search-item">
                        <label>Plac√≥wki</label>
                        <div class="custom-select-container">
                            <button class="custom-select-trigger" id="clinicsTrigger" onclick="toggleDropdown('clinicsDropdown')">
                                Wybierz...
                            </button>
                            <div class="custom-dropdown" id="clinicsDropdown">
                                <div class="dropdown-search">
                                    <input type="text" placeholder="Szukaj plac√≥wki..." onkeyup="filterDropdown(this, 'clinicsList')">
                                </div>
                                <div class="dropdown-list" id="clinicsList"></div>
                                <div class="dropdown-footer">
                                    <button class="btn btn-sm btn-link" onclick="clearSelection('clinicsList')">Wyczy≈õƒá</button>
                                    <button class="btn btn-sm btn-primary" onclick="toggleDropdown('clinicsDropdown')">Gotowe</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="search-grid" style="margin-top: 20px;">
                    <!-- Daty -->
                    <div class="search-item">
                        <label>Data od</label>
                        <input type="date" id="dateFrom" class="form-control date-input">
                    </div>
                    <div class="search-item">
                        <label>Data do</label>
                        <input type="date" id="dateTo" class="form-control date-input">
                    </div>

                    <!-- Przyciski -->
                    <div class="search-actions">
                        <button id="searchBtn" class="btn btn-primary btn-wide">üîç Wyszukaj</button>
                        <button id="resetBtn" class="btn btn-secondary">üóëÔ∏è Wyczy≈õƒá filtry</button>
                    </div>
                </div>
            </div>

            <!-- Sekcja 3: Akcje na wynikach -->
            <div class="actions-bar">
                <button id="bookSelectedBtn" class="btn btn-success" disabled>‚úÖ Zarezerwuj wybranƒÖ</button>
                <button id="exportBtn" class="btn btn-info">üíæ Eksportuj CSV</button>
                <span id="resultsSource"></span>
            </div>

            <!-- Sekcja 4: Tabela wynik√≥w -->
            <div class="results-table-container">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>üìÖ Data</th>
                            <th>üïí Godzina</th>
                            <th>üë®‚Äç‚öïÔ∏è Lekarz</th>
                            <th>üéØ Specjalno≈õƒá</th>
                            <th>üè• Plac√≥wka</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                        <tr>
                            <td colspan="5" style="text-align:center; padding: 40px; color: #6b7280;">
                                <div style="font-size: 3rem; margin-bottom: 16px;">üîç</div>
                                <div style="font-size: 1.1rem; font-weight: 500;">Brak wynik√≥w</div>
                                <div style="font-size: 0.9rem; margin-top: 8px;">U≈ºyj wyszukiwania lub w≈ÇƒÖcz scheduler</div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Modal Profile -->
            <div id="profilesModal" class="modal hidden">
                <div class="modal-content">
                    <h3>üë• ZarzƒÖdzanie Profilami</h3>
                    <div id="profilesList" class="profiles-list"></div>
                    <hr style="margin: 24px 0; border: none; border-top: 2px solid var(--light);">
                    <h4>‚ûï Dodaj Nowy Profil</h4>
                    <form id="addProfileForm">
                        <input type="text" id="newProfileName" placeholder="Nazwa profilu" required class="form-control">
                        <input type="text" id="newProfileLogin" placeholder="Login" required class="form-control">
                        <input type="password" id="newProfilePass" placeholder="Has≈Ço" required class="form-control">
                        <div style="margin: 12px 0; display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="newProfileIsChild" style="width: 20px; height: 20px;">
                            <label for="newProfileIsChild" style="margin: 0;">Konto dziecka</label>
                        </div>
                        <button type="submit" class="btn btn-success" style="margin-top: 12px; width: 100%;">‚ûï Dodaj Profil</button>
                    </form>
                    <button class="btn btn-secondary close-modal" onclick="toggleProfilesModal()">‚ùå Zamknij</button>
                </div>
            </div>
            
            <!-- Toast Notifications -->
            <div id="toast" class="toast"></div>
        </div>
    </div>

    <script src="/script.js"></script>
</body>
</html>